<div class="admin-tickets-container">
  <!-- Header Section -->
  <div class="admin-tickets-header">
    <div class="header-content">
      <div class="header-text">
        <h2>{{ 'ticketsAdmin.title' | translate }}</h2>
        <p>{{ 'ticketsAdmin.subtitle' | translate }}</p>
      </div>
      <div class="header-actions">
        <button class="btn btn-primary create-ticket-btn" (click)="openCreateTicketModal()">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
            <path d="M12 5v14M5 12h14" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
          </svg>
          {{ 'ticketsAdmin.create' | translate }}
        </button>
      </div>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading" class="loading-state">
    <div class="loading-spinner"></div>
    <p>{{ 'ticketsAdmin.loading' | translate }}</p>
  </div>

  <!-- Error State -->
  <div *ngIf="error" class="error-state">
    <div class="error">{{ error }}</div>
  </div>

  <!-- Tickets Table -->
  <table *ngIf="tickets.length && !loading">
    <thead>
      <tr>
        <th>{{ 'ticketsAdmin.id' | translate }}</th>
        <th>{{ 'ticketsAdmin.type' | translate }}</th>
        <th>{{ 'ticketsAdmin.description' | translate }}</th>
        <th>{{ 'ticketsAdmin.status' | translate }}</th>
        <th>{{ 'ticketsAdmin.created' | translate }}</th>
        <th>{{ 'ticketsAdmin.actions' | translate }}</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let ticket of tickets">
        <td>{{ ticket.id }}</td>
        <td>
          <span class="type-badge" [ngClass]="'type-' + (ticket.type.toLowerCase() || 'autre')">
            {{ 'parameters.interface.' + (ticket.type || 'autre') | translate }}
          </span>
        </td>
        <td>{{ ticket.description }}</td>
        <td>
          <span class="status-badge" [ngClass]="'status-' + (ticket.status?.toLowerCase() || 'nouveau')">
            {{ 'parameters.interface.' + (ticket.status || 'nouveau') | translate }}
          </span>
        </td>
        <td>{{ ticket.createdDate | date: 'short' }}</td>
        <td>
          <button class="btn btn-primary btn-sm" (click)="openDetailModal(ticket)">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
              <path d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" stroke="currentColor" stroke-width="2" />
              <path
                d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"
                stroke="currentColor"
                stroke-width="2"
              />
            </svg>
            {{ 'ticketsAdmin.detail' | translate }}
          </button>
        </td>
      </tr>
    </tbody>
  </table>

  <!-- Empty State -->
  <div *ngIf="!tickets.length && !loading && !error" class="empty-state">
    <div class="empty-icon">
      <svg width="64" height="64" viewBox="0 0 24 24" fill="none">
        <path
          d="M14 2H6C5.46957 2 4.96086 2.21071 4.58579 2.58579C4.21071 2.96086 4 3.46957 4 4V20C4 20.5304 4.21071 21.0391 4.58579 21.4142C4.96086 21.7893 5.46957 22 6 22H18C18.5304 22 19.0391 21.7893 19.4142 21.0391C19.7893 20.7893 20 20.5304 20 20V8L14 2Z"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        />
        <path d="M14 2V8H20" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
        <path d="M16 13H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
        <path d="M16 17H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
        <path d="M10 9H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
      </svg>
    </div>
    <h3>Aucun ticket trouvé</h3>
    <p>{{ 'ticketsAdmin.noTickets' | translate }}</p>
  </div>

  <!-- Modale de détail/modification du ticket -->
  <div
    *ngIf="showDetailModal"
    style="
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.6);
      z-index: 9999;
      display: flex;
      align-items: center;
      justify-content: center;
      backdrop-filter: blur(8px);
    "
  >
    <div class="admin-ticket-modal">
      <button (click)="closeDetailModal()" class="close-modal-btn" aria-label="Fermer">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
          <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
        </svg>
      </button>
      <h3>{{ 'ticketsAdmin.detail' | translate }}</h3>
      <div *ngIf="selectedTicket">
        <div class="admin-ticket-row">
          <div class="admin-ticket-label">{{ 'ticketsAdmin.type' | translate }} :</div>
          <div class="admin-ticket-value">
            <span class="type-badge" [ngClass]="'type-' + (selectedTicket.type.toLowerCase() || 'autre')">
              {{ 'parameters.interface.' + (selectedTicket.type || 'autre') | translate }}
            </span>
          </div>
        </div>
        <div class="admin-ticket-row">
          <div class="admin-ticket-label">{{ 'ticketsAdmin.description' | translate }} :</div>
          <div class="admin-ticket-value">{{ selectedTicket.description }}</div>
        </div>

        <!-- Affichage de l'image si elle existe -->
        <div *ngIf="selectedTicket.imageUrl" class="admin-ticket-row">
          <div class="admin-ticket-label">{{ 'ticketsAdmin.image' | translate }} :</div>
          <div class="admin-ticket-value">
            <div class="admin-ticket-image-container">
              <img
                [src]="selectedTicket.imageUrl"
                alt="Image du ticket"
                class="admin-ticket-image"
                (click)="openImageModal(selectedTicket.imageUrl)"
              />
              <div class="admin-ticket-image-overlay">
                <span>Cliquez pour agrandir</span>
              </div>
            </div>
          </div>
        </div>

        <div class="admin-ticket-row">
          <div class="admin-ticket-label">{{ 'ticketsAdmin.status' | translate }} :</div>
          <div class="admin-ticket-value">
            <select [(ngModel)]="selectedTicket.status" class="status-select">
              <option value="Nouveau">{{ 'parameters.interface.Nouveau' | translate }}</option>
              <option value="En cours">{{ 'parameters.interface.En cours' | translate }}</option>
              <option value="Résolu">{{ 'parameters.interface.Résolu' | translate }}</option>
              <option value="En attente de paiement">En attente de paiement</option>
              <option value="Paiement validé">{{ 'parameters.interface.Paiement validé' | translate }}</option>
              <option value="Fermé">{{ 'parameters.interface.Fermé' | translate }}</option>
              <option value="Urgent">{{ 'parameters.interface.Urgent' | translate }}</option>
            </select>
          </div>
        </div>
        <!-- Section Chat Professionnel -->
        <div class="admin-ticket-row chat-section">
          <div class="admin-ticket-label" style="align-self: flex-start">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
              <path
                d="M8 12h8m-8 4h4m-4-8h8M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
              />
            </svg>
            {{ 'ticketsAdmin.messages' | translate }}
          </div>
          <div class="admin-ticket-value chat-container" style="width: 100%">
            <!-- En-tête du chat -->
            <div class="chat-header">
              <div class="chat-title">
                <h5>Conversation avec {{ selectedTicket.clientName || selectedTicket.clientEmail || 'client' }}</h5>
                <span class="chat-status-badge" [ngClass]="'status-' + (selectedTicket.status?.toLowerCase() || 'nouveau')">
                  {{ selectedTicket.status }}
                </span>
              </div>
              <div class="chat-actions">
                <button
                  class="chat-action-btn"
                  title="Marquer comme urgent"
                  [class.active]="selectedTicket.status === 'Urgent'"
                  (click)="selectedTicket.status = 'Urgent'; saveTicket()"
                >
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                    <path
                      d="M10.29 3.86L1.82 18A2 2 0 0 0 3.54 21H20.46A2 2 0 0 0 22.18 18L13.71 3.86A2 2 0 0 0 10.29 3.86Z"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    />
                    <path d="M12 9V13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                    <path d="M12 17H12.01" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                  </svg>
                </button>
                <button
                  class="chat-action-btn"
                  title="Marquer comme résolu"
                  [class.active]="selectedTicket.status === 'Résolu'"
                  (click)="selectedTicket.status = 'Résolu'; saveTicket()"
                >
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                    <path d="M20 6L9 17l-5-5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                  </svg>
                </button>
                <button
                  class="chat-action-btn"
                  title="Envoyer la facture"
                  [class.active]="selectedTicket.status === 'Résolu'"
                  (click)="sendPaymentValidationToClient(selectedTicket)"
                  *ngIf="selectedTicket.status === 'Résolu'"
                >
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                    <path d="M9 12l2 2 4-4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                    <path
                      d="M21 12c-1 0-3-1-3-3s2-3 3-3 3 1 3 3-2 3-3 3"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    />
                    <path
                      d="M3 12c1 0 3-1 3-3s-2-3-3-3-3 1-3 3 2 3 3 3"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    />
                  </svg>
                </button>
                <button
                  class="chat-action-btn"
                  title="Valider le paiement"
                  [class.active]="selectedTicket.status === 'En attente de paiement'"
                  (click)="validatePayment(selectedTicket)"
                  *ngIf="selectedTicket.status === 'En attente de paiement'"
                >
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                    <path d="M9 12l2 2 4-4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                    <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" />
                  </svg>
                </button>
              </div>
            </div>

            <!-- Zone des messages -->
            <div class="messages-container">
              <div
                *ngFor="let msg of selectedTicket.messageStrings; let i = index"
                class="message-bubble"
                [ngClass]="{ 'admin-message': !msg.startsWith('[CLIENT]'), 'client-message': msg.startsWith('[CLIENT]') }"
              >
                <div class="message-header">
                  <div class="message-author">
                    <div
                      class="author-avatar"
                      [ngClass]="{ 'admin-avatar': !msg.startsWith('[CLIENT]'), 'client-avatar': msg.startsWith('[CLIENT]') }"
                    >
                      <svg width="14" height="14" viewBox="0 0 24 24" fill="none">
                        <path
                          d="M20 21V19C20 17.9391 19.5786 16.9217 18.8284 16.1716C18.0783 15.4214 17.0609 15 16 15H8C6.93913 15 5.92172 15.4214 5.17157 16.1716C4.42143 16.9217 4 17.9391 4 19V21"
                          stroke="currentColor"
                          stroke-width="2"
                          stroke-linecap="round"
                          stroke-linejoin="round"
                        />
                        <circle
                          cx="12"
                          cy="7"
                          r="4"
                          stroke="currentColor"
                          stroke-width="2"
                          stroke-linecap="round"
                          stroke-linejoin="round"
                        />
                      </svg>
                    </div>
                    <span class="author-name">
                      {{ msg.startsWith('[CLIENT]') ? selectedTicket.clientName || selectedTicket.clientEmail || 'Client' : 'Admin' }}
                    </span>
                  </div>
                  <span class="message-time">{{ getMessageTime(i) }}</span>
                </div>
                <div class="message-content">
                  {{ msg.startsWith('[CLIENT]') ? msg.substring(8) : msg }}
                </div>
              </div>
            </div>

            <!-- Zone de saisie du message -->
            <div class="chat-input">
              <div class="input-container">
                <textarea
                  [(ngModel)]="newMessage"
                  placeholder="{{ 'ticketsAdmin.addMessage' | translate }}"
                  rows="3"
                  class="message-textarea"
                  maxlength="500"
                  (keydown.enter)="$event.preventDefault(); sendMessage()"
                >
                </textarea>
                <div class="input-actions">
                  <span class="char-count">{{ newMessage.length }}/500</span>
                  <button class="send-btn" (click)="sendMessage()" [disabled]="!newMessage.trim()">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                      <path
                        d="M22 2L11 13M22 2L15 22L11 13M11 13L2 9L22 2"
                        stroke="currentColor"
                        stroke-width="2"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                      />
                    </svg>
                    {{ 'ticketsAdmin.sendMessage' | translate }}
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Section Actions du Workflow -->
        <div class="admin-ticket-row">
          <div class="admin-ticket-label">Actions du workflow :</div>
          <div class="admin-ticket-value">
            <div class="workflow-actions">
              <!-- Action pour créer un devis -->
              <div *ngIf="canCreateDevis(selectedTicket)" class="action-section">
                <button type="button" class="btn btn-primary btn-sm" (click)="openDevisModal(selectedTicket)">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                    <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                  </svg>
                  Créer un devis
                </button>
              </div>

              <!-- Action pour démarrer le travail -->

              <!-- Action pour résoudre le ticket -->
              <div *ngIf="canResolve(selectedTicket)" class="action-section">
                <button type="button" class="btn btn-warning btn-sm" (click)="selectedTicket.status = 'Résolu'; saveTicket()">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                    <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                  </svg>
                  Marquer comme résolu
                </button>
              </div>

              <!-- Action pour envoyer la facture de paiement (ticket résolu) -->
              <div *ngIf="selectedTicket && canSendInvoice(selectedTicket)" class="action-section">
                <button type="button" class="btn btn-success btn-sm" (click)="sendPaymentValidationToClient(selectedTicket)">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                    <path
                      d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M7 10l5 5 5-5M12 15V3"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    />
                  </svg>
                  Envoyer la facture de paiement
                </button>
              </div>

              <!-- Action pour envoyer la validation du paiement au client -->
              <div *ngIf="canValidatePayment(selectedTicket)" class="action-section">
                <button type="button" class="btn btn-info btn-sm" (click)="sendPaymentValidationToClient(selectedTicket)">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                    <path
                      d="M22 2L11 13M22 2L15 22L11 13M11 13L2 9L22 2"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    />
                  </svg>
                  Envoyer la validation du paiement
                </button>
              </div>

              <!-- Action pour fermer le ticket -->
              <div *ngIf="canClose(selectedTicket)" class="action-section">
                <button type="button" class="btn btn-secondary btn-sm" (click)="selectedTicket.status = 'Fermé'; saveTicket()">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                    <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
                  </svg>
                  Fermer le ticket
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- Section Paiement (affichée uniquement après envoi de la facture) -->
        <div
          class="admin-ticket-row"
          *ngIf="selectedTicket?.status === 'En attente de paiement' || selectedTicket?.status === 'Paiement validé'"
        >
          <div class="admin-ticket-label">Paiement :</div>
          <div class="admin-ticket-value">
            <jhi-ticket-payment
              [ticketId]="selectedTicket.id"
              [ticketType]="selectedTicket.type"
              (paymentCompleted)="onPaymentCompleted($event)"
            >
            </jhi-ticket-payment>
          </div>
        </div>

        <div class="admin-ticket-actions">
          <button class="btn btn-success btn-sm" (click)="saveTicket()">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
              <path d="M20 6L9 17l-5-5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
            </svg>
            {{ 'ticketsAdmin.save' | translate }}
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal pour afficher l'image en plein écran -->
  <div *ngIf="showImageModal" class="image-modal-overlay" (click)="closeImageModal()">
    <div class="image-modal-container" (click)="$event.stopPropagation()">
      <button class="image-modal-close-btn" (click)="closeImageModal()">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
          <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
        </svg>
      </button>
      <img [src]="selectedImageUrl" alt="Image du ticket" class="full-size-image" />
    </div>
  </div>

  <!-- Modal de création de ticket -->
  <div
    *ngIf="showCreateModal"
    style="
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.6);
      z-index: 9999;
      display: flex;
      align-items: center;
      justify-content: center;
      backdrop-filter: blur(8px);
    "
  >
    <div class="admin-create-ticket-modal">
      <button (click)="closeCreateTicketModal()" class="close-modal-btn" aria-label="Fermer">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
          <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
        </svg>
      </button>
      <h3>{{ 'ticketsAdmin.create' | translate }}</h3>

      <form (ngSubmit)="createTicket()" #createTicketForm="ngForm">
        <div class="form-group">
          <label for="ticketType">{{ 'ticketsAdmin.type' | translate }} *</label>
          <select id="ticketType" name="type" [(ngModel)]="newTicket.type" required class="form-control">
            <option value="">{{ 'ticketsAdmin.selectType' | translate }}</option>
            <option value="DEMANDE">{{ 'parameters.interface.DEMANDE' | translate }}</option>
            <option value="BUG">{{ 'parameters.interface.BUG' | translate }}</option>
            <option value="AMELIORATION">{{ 'parameters.interface.AMELIORATION' | translate }}</option>
            <option value="SUPPORT">{{ 'parameters.interface.SUPPORT' | translate }}</option>
          </select>
        </div>

        <div class="form-group">
          <label for="ticketDescription">{{ 'ticketsAdmin.description' | translate }} *</label>
          <textarea
            id="ticketDescription"
            name="description"
            [(ngModel)]="newTicket.description"
            required
            class="form-control"
            rows="4"
            placeholder="{{ 'ticketsAdmin.descriptionPlaceholder' | translate }}"
          ></textarea>
        </div>

        <div class="form-group">
          <label for="ticketStatus">{{ 'ticketsAdmin.status' | translate }}</label>
          <select id="ticketStatus" name="status" [(ngModel)]="newTicket.status" class="form-control">
            <option value="Nouveau">{{ 'parameters.interface.Nouveau' | translate }}</option>
            <option value="En cours">{{ 'parameters.interface.En cours' | translate }}</option>
            <option value="Urgent">{{ 'parameters.interface.Urgent' | translate }}</option>
          </select>
        </div>

        <div class="form-group">
          <label for="clientEmail">{{ 'ticketsAdmin.clientEmail' | translate }}</label>
          <input
            type="email"
            id="clientEmail"
            name="clientEmail"
            [(ngModel)]="newTicket.clientEmail"
            class="form-control"
            placeholder="{{ 'ticketsAdmin.clientEmailPlaceholder' | translate }}"
          />
        </div>

        <div class="form-actions">
          <button type="button" class="btn btn-secondary" (click)="closeCreateTicketModal()">
            {{ 'ticketsAdmin.cancel' | translate }}
          </button>
          <button type="submit" class="btn btn-primary" [disabled]="!createTicketForm.valid || creating">
            <span *ngIf="creating">{{ 'ticketsAdmin.creating' | translate }}</span>
            <span *ngIf="!creating">{{ 'ticketsAdmin.create' | translate }}</span>
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- Modal pour créer un devis -->
  <div
    *ngIf="showDevisModal"
    style="
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.6);
      z-index: 9999;
      display: flex;
      align-items: center;
      justify-content: center;
      backdrop-filter: blur(8px);
    "
  >
    <div class="admin-devis-modal">
      <button (click)="closeDevisModal()" class="close-modal-btn" aria-label="Fermer">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
          <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
        </svg>
      </button>
      <h3>Créer un devis</h3>

      <div class="devis-info" *ngIf="selectedTicketForDevis">
        <p>
          <strong>Ticket #{{ selectedTicketForDevis.id }}</strong>
        </p>
        <p>{{ selectedTicketForDevis.type }} - {{ selectedTicketForDevis.description }}</p>
      </div>

      <form (ngSubmit)="submitDevis()" #devisForm="ngForm">
        <div class="form-group">
          <label for="devisAmount">Montant (MAD) *</label>
          <input
            type="number"
            id="devisAmount"
            name="amount"
            [(ngModel)]="devisAmount"
            required
            class="form-control"
            placeholder="0.00"
            min="0"
            step="0.01"
          />
        </div>

        <div class="form-group">
          <label for="devisDescription">Description du devis</label>
          <textarea
            id="devisDescription"
            name="description"
            [(ngModel)]="devisDescription"
            class="form-control"
            rows="4"
            placeholder="Détails du devis, prestations incluses..."
          ></textarea>
        </div>

        <div class="form-actions">
          <button type="button" class="btn btn-secondary" (click)="closeDevisModal()">Annuler</button>
          <button type="submit" class="btn btn-primary" [disabled]="!devisForm.valid || submittingDevis">
            <span *ngIf="submittingDevis">Envoi en cours...</span>
            <span *ngIf="!submittingDevis">Envoyer le devis</span>
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Pagination Section -->
<div class="pagination-section" *ngIf="tickets.length > 0 && !loading">
  <div class="pagination-info">
    <jhi-item-count [params]="{ page, totalItems, itemsPerPage }" />
  </div>
  <div class="pagination-controls">
    <ngb-pagination
      [collectionSize]="totalItems"
      [(page)]="page"
      [pageSize]="itemsPerPage"
      [maxSize]="5"
      [rotate]="true"
      [boundaryLinks]="true"
      (pageChange)="onPageChange($event)"
      class="modern-pagination"
    ></ngb-pagination>
  </div>
</div>
